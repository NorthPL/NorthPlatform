/**
 * Base build script for Java projects.
 */

subprojects {
    apply plugin: 'java'
    apply plugin: 'io.franzbecker.gradle-lombok'
    apply plugin: 'com.github.johnrengelman.shadow'

    lombok {
        // Manually set lombok version because default one doesnt't work on Java 11
        version = "1.18.4"
    }

    jar {
        // Add some attributes to every manifest
        manifest {
            attributes 'Name': project.name
            attributes 'Implementation-Version': project.version
        }
    }

    shadowJar {
        archiveName "${project.name}.jar"
    }

    sourceCompatibility = JavaVersion.VERSION_1_8
    targetCompatibility = JavaVersion.VERSION_1_8

    compileJava.options.encoding = "UTF-8"
    compileTestJava.options.encoding = "UTF-8"

    // execute shadowJar when we run 'gradle build'
    tasks.build.dependsOn tasks.shadowJar
}